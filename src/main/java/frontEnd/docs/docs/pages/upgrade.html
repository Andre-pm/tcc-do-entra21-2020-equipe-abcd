<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/upgrade.css">
    <title>Conta Comercial</title>
</head>

<body>
    <header>

    </header>
    <main>
        <div class="gradient">
            <div class="glass">
                <h2>Upgrade para Conta Comercial</h2>

                <form action="" id="formCadastro">
                    <label for="idNomeFantasia">Insira o Nome Comercial da Loja:</label><br>
                    <input type="text" name="Nome da Loja" id="idNomeFantasia">
                    <br><br>
                    <label for="idLogo">Insira a logo da sua loja:</label><br>
                    <input type="file" name="imagem" id="idLogo">
                    <br><br>
                    <label for="idCatLoja">Selecione a Categoria da Loja:</label><br>
                    <select name="CategoriaLoja" id="idCatLoja">
                        <option value="Mercado">Mercado</option>
                        <option value="Padaria">Padaria</option>
                        <option value="Brecho">Brechó</option>
                        <option value="Artesanato">Artesanato</option>
                        <option value="SaloesdeBeleza">Salão de Beleza</option>
                        <option value="Farmacia">Farmacia</option>
                        <option value="Ferramentas">Loja de Ferramentas</option>
                        <option value="AssistenciaTec">Assistência Técnica</option>
                    </select>
                    <br><br>
                    <label for="idCnpj">Insira seu CNPJ:</label><br>
                    <input type="number" name="cnpj" id="idCnpj">
                    <br><br>
                    <label for="idLogradouro">Insira o logradouro:</label><br>
                    <input type="text" name="logradouro" id="idLogradouro">
                    <br><br>
                    <label for="idCep">Insira o CEP:</label><br>
                    <input type="number" name="Cep" id="idCep">
                    <br><br>
                    <label for="idBairro">Insira o Bairro:</label><br>
                    <input type="text" name="bairro" id="idBairro">
                    <br><br>
                    <label for="idCidade">Insira a Cidade:</label><br>
                    <input type="text" name="cidade" id="idCidade">
                    <br><br>
                    <label for="idTel">Insira o Telefone Comercial:</label><br>
                    <input type="number" name="Telefone" id="idTel">
                    <br><br>
                </form>
                    <div id="localBotoes">
                        <input type="button" value="Atualizar Conta" id="btnAtt" class="botoes">
                        <a href="../pages/home.html"><input type="button" value="Voltar" id="btnVoltar" class="botoes"></a>
                    </div>
            </div>
        </div>
        <script src="../js/validacao.js"></script>

        <script>
            document.getElementById('btnAtt').addEventListener('click', function(){

                var select = document.getElementById('idCatLoja');
	            var text = select.options[select.selectedIndex].text;
                let comercio = {};
                comercio.contaId = localStorage.getItem("UsuarioId");
                comercio.nomeFantasia = document.getElementById('idNomeFantasia').value;
                comercio.razaoSocial = text;
                comercio.cnpj = document.getElementById('idCnpj').value;
                comercio.logradouro = document.getElementById('idLogradouro').value;
                comercio.numeroEComplemento = '0 Loja Z';
                comercio.telefone = document.getElementById('idTel').value;
                comercio.cep = document.getElementById('idCep').value;
                comercio.bairro = document.getElementById('idBairro').value;
                comercio.cidade = document.getElementById('idCidade').value;
                comercio.contratoSocialHash = 'JASDKASDKASDKJASDKHAS';
               
                
                var json = JSON.stringify(comercio);

                var url = "http://localhost:8081/api/comercios/cria";
                var xhr = new XMLHttpRequest();

                xhr.open("POST", url, true);

                xhr.setRequestHeader('Content-type', 'application/json; charset=utf-8');

                xhr.onload = function () {
                    // var users = JSON.parse(xhr.responseText);
                    // if (xhr.readyState == 4 && xhr.status == "201") {
                    //   console.table(users);
                    // } else {
                    //   console.error(users);
                    // }

                    // var form = document.getElementById("idForm");
                    // form.reset();
                }
                if (comercio.nomeFantasia == '' | comercio.cnpj == '' | comercio.logradouro == '' | comercio.telefone == '' | comercio.cep == '' | comercio.bairro == '' | comercio.cidade == '') {
                    alert('Preencha os campos corretamente');
                }
                else{
                    xhr.send(json);
                    window.location.href = "home.html";
                }

            });
        </script>
    </main>
    <footer>

    </footer>
</body>

</html>