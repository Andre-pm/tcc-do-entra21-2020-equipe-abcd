<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href='https://css.gg/menu.css' rel='stylesheet'>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/categorias.css">
    <title>Mercados</title>
</head>
<body>
    <header>
        <div class="barraPesquisa">
            <h2 id="tituloBarra">Olá</h2>
            <div id="pesquisaSpace">
                <img id="search" src="../assets/search.png">
                <input id="inputPesquisa" type="text" name="Buscar" id="idBuscar" placeholder="O que você precisa?">
            </div>
            <div class="topnav">
                <div class="active">
                    <div id="myLinks">
                        <a href="../pages/home.html">Home</a>
                        <a href="../pages/upgrade.html">Conta Comercial</a>
                    </div>
                    <a href="javascript:void(0);" class="icon" onclick="menu()">
                        <i class="gg-menu"></i>
                    </a>
                </div>
            </div>
        </div>
    </header>
    <main>
        <table id="selecao">
            <h2 id="titulo">Mercados</h2>
            
            

            </div>
        </table>
    </main>
<script src="../js/menu.js"></script>    

<script>
        const xhr = new XMLHttpRequest;
        xhr.open("GET", "http://localhost:8081/api/comercios/busca/tipo/Mercado");
        xhr.addEventListener("load", function () {  
            var resposta = xhr.responseText;
            resposta = JSON.parse(resposta);
            if(resposta.length == 0){
                alert('Estabelecimentos não encontrados');
            }
            else{
                for (let index = 0; index < resposta.length; index++) {
                    let newTr = document.createElement('tr');
                    let newTd = document.createElement('td');
                    let newDiv = document.createElement('div');
                    let newDivGeral = document.createElement('div');
                    let newH2NomePreco = document.createElement('h2'); 
                    let newH2MercadoDistancia = document.createElement('h2'); 

                    newTd.id = 'loja';
                    newDiv.id = 'logoLoja';
                    newDivGeral.id = 'divGeral';

                    newH2NomePreco.textContent = resposta[index].nomeFantasia;
                    newH2MercadoDistancia.textContent = resposta[index].cidade+" | "+ resposta[index].bairro+" | "+ resposta[index].logradouro;
                    newDivGeral.appendChild(newH2NomePreco);
                    newDivGeral.appendChild(newH2MercadoDistancia);
                    newTd.appendChild(newDiv);
                    newTd.appendChild(newDivGeral);
                    newTr.appendChild(newTd);
                
                    document.getElementById('selecao').appendChild(newTr);
                }
            }
        })
        xhr.send();     

</script>
</body>
</html>